import math
import pandas as pd


def calculate_dist_between_airports(airport1_code, airport2_code):
    def calc_distance(x1, y1, x2, y2):
        distance = math.sqrt(math.pow((x2 - x1), 2) + math.pow((math.cos((x1 * math.pi) / 180) * (y2 - y1)), 2)) * (40075.704 / 360)
        distance = round(distance, 2)
        return distance

    airports = pd.read_csv('https://davidmegginson.github.io/ourairports-data/airports.csv', sep=',')
    del airports['home_link'], airports['iso_region'], airports['continent'], airports['wikipedia_link'], airports['elevation_ft'], airports['scheduled_service'], airports['gps_code'], airports['local_code'], airports['keywords']
    airports = airports.loc[airports.iata_code.notnull()]  # Remove airports without IATA code

    try:
        airport1_data = airports.loc[airports['iata_code'] == airport1_code, ['name', 'latitude_deg', 'longitude_deg']].iloc[0]
        airport2_data = airports.loc[airports['iata_code'] == airport2_code, ['name', 'latitude_deg', 'longitude_deg']].iloc[0]

        distance = calc_distance(airport1_data['latitude_deg'], airport1_data['longitude_deg'], airport2_data['latitude_deg'], airport2_data['longitude_deg'])
        distance = round(distance, 2)
        return distance
    except IndexError:
        print("Please enter correct IATA codes")

def get_all_airports():
    return {'FLL': 'Fort Lauderdale, FL', 'MSP': 'Minneapolis, MN', 'DEN': 'Denver, CO', 'MCO': 'Orlando, FL', 'DAL': 'Dallas, TX', 'DCA': 'Washington, DC', 'HSV': 'Huntsville, AL', 'IAH': 'Houston, TX', 'SEA': 'Seattle, WA', 'ATL': 'Atlanta, GA', 'RDU': 'Raleigh/Durham, NC', 'MDW': 'Chicago, IL', 'BDL': 'Hartford, CT', 'BWI': 'Baltimore, MD', 'STT': 'Charlotte Amalie, VI', 'SRQ': 'Sarasota/Bradenton, FL', 'JFK': 'New York, NY', 'GRR': 'Grand Rapids, MI', 'DFW': 'Dallas/Fort Worth, TX', 'CLT': 'Charlotte, NC', 'ORD': 'Chicago, IL', 'LAS': 'Las Vegas, NV', 'TUL': 'Tulsa, OK', 'USA': 'CONCORD, NC', 'SLC': 'Salt Lake City, UT', 'BNA': 'Nashville, TN', 'AUS': 'Austin, TX', 'IND': 'Indianapolis, IN', 'MHT': 'Manchester, NH', 'SFO': 'San Francisco, CA', 'PRC': 'Prescott, AZ', 'BOS': 'Boston, MA', 'LAX': 'Los Angeles, CA', 'SMF': 'Sacramento, CA', 'DTW': 'Detroit, MI', 'SAT': 'San Antonio, TX', 'MSY': 'New Orleans, LA', 'CMH': 'Columbus, OH', 'STL': 'St. Louis, MO', 'SJU': 'San Juan, PR', 'PHX': 'Phoenix, AZ', 'TPA': 'Tampa, FL', 'LGA': 'New York, NY', 'PHL': 'Philadelphia, PA', 'GRK': 'Killeen, TX', 'ILM': 'Wilmington, NC', 'JLN': 'Joplin, MO', 'MKE': 'Milwaukee, WI', 'BIL': 'Billings, MT', 'BLI': 'Bellingham, WA', 'CHS': 'Charleston, SC', 'RIC': 'Richmond, VA', 'GSO': 'Greensboro/High Point, NC', 'MCI': 'Kansas City, MO', 'EWR': 'Newark, NJ', 'ELP': 'El Paso, TX', 'SDF': 'Louisville, KY', 'HPN': 'White Plains, NY', 'SAN': 'San Diego, CA', 'BHM': 'Birmingham, AL', 'SJC': 'San Jose, CA', 'ASE': 'Aspen, CO', 'HNL': 'Honolulu, HI', 'MAF': 'Midland/Odessa, TX', 'BUF': 'Buffalo, NY', 'TUS': 'Tucson, AZ', 'SYR': 'Syracuse, NY', 'MSN': 'Madison, WI', 'FAT': 'Fresno, CA', 'FWA': 'Fort Wayne, IN', 'LAN': 'Lansing, MI', 'ABI': 'Abilene, TX', 'ICT': 'Wichita, KS', 'CMI': 'Champaign/Urbana, IL', 'OAK': 'Oakland, CA', 'IAD': 'Washington, DC', 'EUG': 'Eugene, OR', 'MIA': 'Miami, FL', 'CHA': 'Chattanooga, TN', 'BTV': 'Burlington, VT', 'RSW': 'Fort Myers, FL', 'PDX': 'Portland, OR', 'SNA': 'Santa Ana, CA', 'PIT': 'Pittsburgh, PA', 'OGG': 'Kahului, HI', 'HRL': 'Harlingen/San Benito, TX', 'BIS': 'Bismarck/Mandan, ND', 'SHR': 'Sheridan, WY', 'BOI': 'Boise, ID', 'RNO': 'Reno, NV', 'GSP': 'Greer, SC', 'MLB': 'Melbourne, FL', 'GRB': 'Green Bay, WI', 'CRW': 'Charleston/Dunbar, WV', 'LGB': 'Long Beach, CA', 'OKC': 'Oklahoma City, OK', 'PVD': 'Providence, RI', 'YAK': 'Yakutat, AK', 'CID': 'Cedar Rapids/Iowa City, IA', 'FSD': 'Sioux Falls, SD', 'HYS': 'Hays, KS', 'VPS': 'Valparaiso, FL', 'ROC': 'Rochester, NY', 'SAV': 'Savannah, GA', 'CLE': 'Cleveland, OH', 'RDD': 'Redding, CA', 'ANC': 'Anchorage, AK', 'DVL': 'Devils Lake, ND', 'SWO': 'Stillwater, OK', 'BUR': 'Burbank, CA', 'PIR': 'Pierre, SD', 'HOU': 'Houston, TX', 'PBI': 'West Palm Beach/Palm Beach, FL', 'MLI': 'Moline, IL', 'AZA': 'Phoenix, AZ', 'MKG': 'Muskegon, MI', 'PNS': 'Pensacola, FL', 'MYR': 'Myrtle Beach, SC', 'GTF': 'Great Falls, MT', 'LSE': 'La Crosse, WI', 'RDM': 'Bend/Redmond, OR', 'ORF': 'Norfolk, VA', 'KOA': 'Kona, HI', 'MQT': 'Marquette, MI', 'COS': 'Colorado Springs, CO', 'CVG': 'Cincinnati, OH', 'MOB': 'Mobile, AL', 'AVL': 'Asheville, NC', 'BTR': 'Baton Rouge, LA', 'JNU': 'Juneau, AK', 'CDC': 'Cedar City, UT', 'SPS': 'Wichita Falls, TX', 'ECP': 'Panama City, FL', 'JAX': 'Jacksonville, FL', 'SBN': 'South Bend, IN', 'RAP': 'Rapid City, SD', 'AMA': 'Amarillo, TX', 'JMS': 'Jamestown, ND', 'SFB': 'Sanford, FL', 'ABQ': 'Albuquerque, NM', 'ALB': 'Albany, NY', 'BGM': 'Binghamton, NY', 'MGM': 'Montgomery, AL', 'MEM': 'Memphis, TN', 'ONT': 'Ontario, CA', 'TVC': 'Traverse City, MI', 'GEG': 'Spokane, WA', 'OMA': 'Omaha, NE', 'ISP': 'Islip, NY', 'DLH': 'Duluth, MN', 'PIE': 'St. Petersburg, FL', 'PSP': 'Palm Springs, CA', 'ACY': 'Atlantic City, NJ', 'BJI': 'Bemidji, MN', 'LBB': 'Lubbock, TX', 'SHV': 'Shreveport, LA', 'TTN': 'Trenton, NJ', 'PIA': 'Peoria, IL', 'GNV': 'Gainesville, FL', 'PWM': 'Portland, ME', 'BZN': 'Bozeman, MT', 'BRW': 'Barrow, AK', 'MFR': 'Medford, OR', 'GPT': 'Gulfport/Biloxi, MS', 'ATW': 'Appleton, WI', 'DSM': 'Des Moines, IA', 'CKB': 'Clarksburg/Fairmont, WV', 'SGU': 'St. George, UT', 'SBA': 'Santa Barbara, CA', 'OTZ': 'Kotzebue, AK', 'BGR': 'Bangor, ME', 'XNA': 'Fayetteville, AR', 'CAE': 'Columbia, SC', 'SGF': 'Springfield, MO', 'PGD': 'Punta Gorda, FL', 'VLD': 'Valdosta, GA', 'CPR': 'Casper, WY', 'LIH': 'Lihue, HI', 'JAN': 'Jackson/Vicksburg, MS', 'OAJ': 'Jacksonville/Camp Lejeune, NC', 'ABE': 'Allentown/Bethlehem/Easton, PA', 'EGE': 'Eagle, CO', 'CRP': 'Corpus Christi, TX', 'FNT': 'Flint, MI', 'WRG': 'Wrangell, AK', 'FCA': 'Kalispell, MT', 'CHO': 'Charlottesville, VA', 'MRY': 'Monterey, CA', 'SCE': 'State College, PA', 'AEX': 'Alexandria, LA', 'MCW': 'Mason City, IA', 'RST': 'Rochester, MN', 'SIT': 'Sitka, AK', 'BMI': 'Bloomington/Normal, IL', 'ACV': 'Arcata/Eureka, CA', 'GCC': 'Gillette, WY', 'LFT': 'Lafayette, LA', 'ITO': 'Hilo, HI', 'ABY': 'Albany, GA', 'GRI': 'Grand Island, NE', 'BPT': 'Beaumont/Port Arthur, TX', 'APN': 'Alpena, MI', 'TLH': 'Tallahassee, FL', 'FSM': 'Fort Smith, AR', 'ALO': 'Waterloo, IA', 'FAY': 'Fayetteville, NC', 'GJT': 'Grand Junction, CO', 'IAG': 'Niagara Falls, NY', 'FLG': 'Flagstaff, AZ', 'LBE': 'Latrobe, PA', 'CAK': 'Akron, OH', 'BFL': 'Bakersfield, CA', 'VEL': 'Vernal, UT', 'STX': 'Christiansted, VI', 'TYS': 'Knoxville, TN', 'EYW': 'Key West, FL', 'AVP': 'Scranton/Wilkes-Barre, PA', 'KTN': 'Ketchikan, AK', 'EVV': 'Evansville, IN', 'BRO': 'Brownsville, TX', 'SWF': 'Newburgh/Poughkeepsie, NY', 'LIT': 'Little Rock, AR', 'GGG': 'Longview, TX', 'MSO': 'Missoula, MT', 'PSC': 'Pasco/Kennewick/Richland, WA', 'SLN': 'Salina, KS', 'SBP': 'San Luis Obispo, CA', 'BIH': 'Bishop, CA', 'MLU': 'Monroe, LA', 'HOB': 'Hobbs, NM', 'DAY': 'Dayton, OH', 'DBQ': 'Dubuque, IA', 'ROW': 'Roswell, NM', 'LEX': 'Lexington, KY', 'PIH': 'Pocatello, ID', 'EWN': 'New Bern/Morehead/Beaufort, NC', 'ESC': 'Escanaba, MI', 'SUX': 'Sioux City, IA', 'PAE': 'Everett, WA', 'CNY': 'Moab, UT', 'CDV': 'Cordova, AK', 'COU': 'Columbia, MO', 'LBF': 'North Platte, NE', 'MFE': 'Mission/McAllen/Edinburg, TX', 'PSE': 'Ponce, PR', 'LAR': 'Laramie, WY', 'FAI': 'Fairbanks, AK', 'SCC': 'Deadhorse, AK', 'MTJ': 'Montrose/Delta, CO', 'SJT': 'San Angelo, TX', 'AGS': 'Augusta, GA', 'MDT': 'Harrisburg, PA', 'ELM': 'Elmira/Corning, NY', 'HDN': 'Hayden, CO', 'MOT': 'Minot, ND', 'IDA': 'Idaho Falls, ID', 'FAR': 'Fargo, ND', 'GFK': 'Grand Forks, ND', 'JAC': 'Jackson, WY', 'LAW': 'Lawton/Fort Sill, OK', 'SUN': 'Sun Valley/Hailey/Ketchum, ID', 'IMT': 'Iron Mountain/Kingsfd, MI', 'LCH': 'Lake Charles, LA', 'CLL': 'College Station/Bryan, TX', 'PHF': 'Newport News/Williamsburg, VA', 'TRI': 'Bristol/Johnson City/Kingsport, TN', 'BET': 'Bethel, AK', 'PBG': 'Plattsburgh, NY', 'BQN': 'Aguadilla, PR', 'BRD': 'Brainerd, MN', 'DAB': 'Daytona Beach, FL', 'DRO': 'Durango, CO', 'STS': 'Santa Rosa, CA', 'ROA': 'Roanoke, VA', 'DDC': 'Dodge City, KS', 'INL': 'International Falls, MN', 'ORH': 'Worcester, MA', 'TXK': 'Texarkana, AR', 'CWA': 'Mosinee, WI', 'BFF': 'Scottsbluff, NE', 'DHN': 'Dothan, AL', 'SCK': 'Stockton, CA', 'LRD': 'Laredo, TX', 'BTM': 'Butte, MT', 'IPT': 'Williamsport, PA', 'PIB': 'Hattiesburg/Laurel, MS', 'HYA': 'Hyannis, MA', 'PVU': 'Provo, UT', 'LBL': 'Liberal, KS', 'AZO': 'Kalamazoo, MI', 'ACK': 'Nantucket, MA', 'YUM': 'Yuma, AZ', 'DRT': 'Del Rio, TX', 'COD': 'Cody, WY', 'LNK': 'Lincoln, NE', 'SHD': 'Staunton, VA', 'CIU': 'Sault Ste. Marie, MI', 'HLN': 'Helena, MT', 'LWB': 'Lewisburg, WV', 'MEI': 'Meridian, MS', 'SAF': 'Santa Fe, NM', 'CYS': 'Cheyenne, WY', 'ABR': 'Aberdeen, SD', 'LCK': 'Columbus, OH', 'RKS': 'Rock Springs, WY', 'GCK': 'Garden City, KS', 'LWS': 'Lewiston, ID', 'EAR': 'Kearney, NE', 'GTR': 'Columbus, MS', 'CSG': 'Columbus, GA', 'RFD': 'Rockford, IL', 'BLV': 'Belleville, IL', 'TYR': 'Tyler, TX', 'CMX': 'Hancock/Houghton, MI', 'PAH': 'Paducah, KY', 'JST': 'Johnstown, PA', 'TOL': 'Toledo, OH', 'PSG': 'Petersburg, AK', 'MHK': 'Manhattan/Ft. Riley, KS', 'YKM': 'Yakima, WA', 'EAT': 'Wenatchee, WA', 'SPI': 'Springfield, IL', 'BQK': 'Brunswick, GA', 'TWF': 'Twin Falls, ID', 'PUB': 'Pueblo, CO', 'DEC': 'Decatur, IL', 'ACT': 'Waco, TX', 'HHH': 'Hilton Head, SC', 'PLN': 'Pellston, MI', 'HIB': 'Hibbing, MN', 'GUC': 'Gunnison, CO', 'ITH': 'Ithaca/Cortland, NY', 'OME': 'Nome, AK', 'MBS': 'Saginaw/Bay City/Midland, MI', 'BFM': 'Mobile, AL', 'ADQ': 'Kodiak, AK', 'LYH': 'Lynchburg, VA', 'RHI': 'Rhinelander, WI', 'ALW': 'Walla Walla, WA', 'DLG': 'Dillingham, AK', 'ALS': 'Alamosa, CO', 'MMH': 'Mammoth Lakes, CA', 'XWA': 'Williston, ND', 'SPN': 'Saipan, TT', 'MVY': "Martha's Vineyard, MA", 'ERI': 'Erie, PA', 'PGV': 'Greenville, NC', 'HGR': 'Hagerstown, MD', 'ATY': 'Watertown, SD', 'SMX': 'Santa Maria, CA', 'HVN': 'New Haven, CT', 'CGI': 'Cape Girardeau, MO', 'BKG': 'Branson, MO', 'DIK': 'Dickinson, ND', 'AKN': 'King Salmon, AK', 'RIW': 'Riverton/Lander, WY', 'FLO': 'Florence, SC', 'GUM': 'Guam, TT', 'EAU': 'Eau Claire, WI', 'TBN': 'Fort Leonard Wood, MO', 'HTS': 'Ashland, WV', 'PSM': 'Portsmouth, NH', 'EKO': 'Elko, NV', 'PUW': 'Pullman, WA', 'FOD': 'Fort Dodge, IA', 'CDB': 'Cold Bay, AK', 'WYS': 'West Yellowstone, MT', 'OTH': 'North Bend/Coos Bay, OR', 'VCT': 'Victoria, TX', 'PPG': 'Pago Pago, TT', 'OGS': 'Ogdensburg, NY', 'ISN': 'Williston, ND', 'ART': 'Watertown, NY', 'ILG': 'Wilmington, DE', 'OWB': 'Owensboro, KY', 'OGD': 'Ogden, UT', 'STC': 'St. Cloud, MN', 'GST': 'Gustavus, AK', 'UIN': 'Quincy, IL', 'ADK': 'Adak Island, AK'}

def get_airport_options():
    return [(key, f"{key}, {value}") for key, value in get_all_airports().items()]

def get_city_from_airport(airport_code):
    return get_all_airports()[airport_code]

def get_all_airlines():
    return {'UA': 'United Air Lines Inc.', 'DL': 'Delta Air Lines Inc.', 'NK': 'Spirit Air Lines', 'WN': 'Southwest Airlines Co.', 'AA': 'American Airlines Inc.', 'YX': 'Republic Airline', 'AS': 'Alaska Airlines Inc.', 'B6': 'JetBlue Airways', 'OH': 'PSA Airlines Inc.', 'G4': 'Allegiant Air', 'EV': 'ExpressJet Airlines LLC d/b/a aha!', 'OO': 'SkyWest Airlines Inc.', '9E': 'Endeavor Air Inc.', 'MQ': 'Envoy Air', 'F9': 'Frontier Airlines Inc.', 'YV': 'Mesa Airlines Inc.', 'QX': 'Horizon Air', 'HA': 'Hawaiian Airlines Inc.'}

def get_airline_options():
    return [(key, f"{key}, {value}") for key, value in get_all_airlines().items()]

def get_airline_from_code(airline_code):
    return get_all_airlines()[airline_code]